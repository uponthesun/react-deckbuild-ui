(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{40:function(t,e,a){t.exports=a(59)},49:function(t,e,a){},59:function(t,e,a){"use strict";a.r(e);var n=a(2),r=a.n(n),o=a(4),c=a(9),i=a(7),s=a(8),l=a(19),u=a(13),d=a(14),h=a(11),m=a(0),p=a.n(m),f=a(17),v=a.n(f),b=a(38),C=a(37),y=a(62),S=a(63),g=(a(49),a(16)),O=function(){function t(e,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(i.a)(this,t),this.cardLoader=e,this.numCols=n,this.loadCardPool(a,r)}return Object(s.a)(t,[{key:"loadCardPool",value:function(){var t=Object(c.a)(r.a.mark((function t(e,a){var n,c,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.cardColumns=Object(g.a)(Array(this.numCols)).map((function(t){return[]})),n=Object(o.a)(e);try{for(n.s();!(c=n.n()).done;)i=c.value,this.createAndAddCards(i).then((function(t){a&&a.setState({})}))}catch(r){n.e(r)}finally{n.f()}case 3:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"createAndAddCards",value:function(){var t=Object(c.a)(r.a.mark((function t(e){var a,n,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.quantity)){t.next=11;break}return t.next=4,this.cardLoader.getCardData(e.name,e.set);case 4:(o=t.sent).currentBoard=this,this.cardColumns[0].push(o),a=o;case 8:n++,t.next=1;break;case 11:return t.abrupt("return",a);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"addCard",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(!a||a>this.cardColumns[e].length)&&(a=this.cardColumns[e].length),this.cardColumns[e].splice(a,0,t),t.currentBoard=this}},{key:"removeCard",value:function(t){for(var e=0;e<this.cardColumns.length;e++)for(var a=this.cardColumns[e],n=0;n<a.length;n++)if(a[n].id===t.id)return a.splice(n,1),t;throw"Tried to remove card, but it wasn't in this board: "+JSON.stringify(t)}},{key:"moveCard",value:function(){var t=Object(c.a)(r.a.mark((function t(e,a,n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.currentBoard.removeCard(e),this.addCard(e,a,n);case 2:case"end":return t.stop()}}),t,this)})));return function(e,a,n){return t.apply(this,arguments)}}()},{key:"numCards",value:function(){return this.cardColumns.flat().length}},{key:"getCards",value:function(){return this.cardColumns.flat()}},{key:"sortByCmc",value:function(){var t,e=Object(g.a)(Array(this.numCols)).map((function(t){return[]})),a=Object(o.a)(this.cardColumns.flat());try{for(a.s();!(t=a.n()).done;){var n=t.value;e[Math.min(n.data.cmc,7)].push(n)}}catch(i){a.e(i)}finally{a.f()}var r,c=Object(o.a)(e);try{for(c.s();!(r=c.n()).done;){r.value.sort((function(t,e){return t.name.localeCompare(e.name)}))}}catch(i){c.e(i)}finally{c.f()}return this.cardColumns=e,this}},{key:"sortByColor",value:function(){var t=Object(g.a)(Array(this.numCols)).map((function(t){return[]})),e=["L","W","U","B","R","G","C","M"],a=this.cardColumns.flat().filter((function(t){return"M"!==t.data.color_pile})),n=this.cardColumns.flat().filter((function(t){return"M"===t.data.color_pile}));n.sort((function(t,e){return t.data.colors.localeCompare(e.data.colors)}));for(var r=0,c=[].concat(Object(g.a)(a),Object(g.a)(n));r<c.length;r++){var i=c[r];t[e.indexOf(i.data.color_pile)].push(i)}var s,l=Object(o.a)(t);try{for(l.s();!(s=l.n()).done;){s.value.sort((function(t,e){return t.name.localeCompare(e.name)}))}}catch(u){l.e(u)}finally{l.f()}return this.cardColumns=t,this}},{key:"asText",value:function(t){var e,a=function(e){var a=e.name;return t&&e.set&&(a+=" (".concat(e.set,")")),a},n={},r=Object(o.a)(this.cardColumns.flat());try{for(r.s();!(e=r.n()).done;){var c=a(e.value);n.hasOwnProperty(c)||(n[c]=0),n[c]++}}catch(i){r.e(i)}finally{r.f()}return Object.entries(n).map((function(t){return"".concat(t[1]," ").concat(t[0])})).join("\n")}}]),t}(),E=function(t){return p.a.createElement("textarea",{id:t.id,rows:"5",cols:"33"},t.initialText)},w=function(t){var e,a=t.split("\n").filter((function(t){return t.trim().length>0})),n=[[],[]],r=n[0],c=Object(o.a)(a);try{for(c.s();!(e=c.n()).done;){var i=e.value;i.includes("Sideboard")?r=n[1]:r.push(k(i))}}catch(s){c.e(s)}finally{c.f()}return n},k=function(t){var e,a,n,r=t.split("("),o=Object(h.a)(r,2),c=o[0],i=o[1];if(n=c[0],Number.isNaN(Number(n)))e=1,a=c.trim();else{var s=c.indexOf(" "),l=c.substring(0,s);l.endsWith("x")&&(l=l.slice(0,-1)),e=Number(l),a=c.substring(s).trim()}var u="";return i&&(u=i.split(")")[0].trim()),{name:a,quantity:e,set:u}},j=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"load",value:function(){var t=document.getElementById(this.props.inputElementId).value,e=w(t),a=Object(h.a)(e,2),n=a[0],r=a[1],o=this.props.topLevelContainer.state.boardState.numCols,c=this.props.topLevelContainer.state.cardLoader;this.props.topLevelContainer.setState({boardState:new O(c,n,o,this.props.topLevelContainer),sideboardState:new O(c,r,1,this.props.topLevelContainer)})}},{key:"render",value:function(){var t=this;return p.a.createElement("input",{type:"button",onClick:function(){return t.load()},value:"Load cards"})}}]),a}(p.a.Component),x=function(t,e,a){return t.asText(a)+"\n\n// Sideboard\n"+e.asText(a)},L=function(t){navigator.clipboard.writeText(t).then((function(){return alert("Copied to clipboard:\n\n".concat(t))}),(function(){return alert("Failed to copy to clipboard")}))},M=function(t){return p.a.createElement("input",{type:"button",onClick:function(){var e=x(t.boardState,t.sideboardState,!1);L(e)},value:"Export to Cockatrice"})},B=function(t){return p.a.createElement("input",{type:"button",onClick:function(){var e=window.btoa(x(t.boardState,t.sideboardState,!0));window.history.replaceState({},"","?cards=".concat(e)),L(window.location.href)},value:"Copy Link"})};function D(t){var e=t.id+"-selector",a=t.id+"-input-count";return p.a.createElement("div",null,p.a.createElement("select",{id:e},p.a.createElement("option",{value:"Snow-Covered Plains"},"Snow-Covered Plains"),p.a.createElement("option",{value:"Snow-Covered Island"},"Snow-Covered Island"),p.a.createElement("option",{value:"Snow-Covered Swamp"},"Snow-Covered Swamp"),p.a.createElement("option",{value:"Snow-Covered Mountain"},"Snow-Covered Mountain"),p.a.createElement("option",{value:"Snow-Covered Forest"},"Snow-Covered Forest")),p.a.createElement("input",{type:"number",min:"0",max:"20",placeholder:"1",id:a}),p.a.createElement("input",{type:"button",onClick:function(){var n=document.getElementById(e).value,r=parseInt(document.getElementById(a).value)||1;t.addLand(n,r,"ICE")},value:"Add Basic Lands"}))}var I=function(){function t(){Object(i.a)(this,t),this.nextId=0,this.cardDataCache={}}return Object(s.a)(t,[{key:"getCardData",value:function(){var t=Object(c.a)(r.a.mark((function t(e){var a,n,o=arguments;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.length>1&&void 0!==o[1]?o[1]:"",n={name:e,set:a,id:this.nextId},this.nextId++,this.cardDataCache[e]||(this.cardDataCache[e]={}),this.cardDataCache[e][a]){t.next=8;break}return t.next=7,this.getScryfallCardData(e,a);case 7:this.cardDataCache[e][a]=t.sent;case 8:return n.data=this.cardDataCache[e][a],t.abrupt("return",n);case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getScryfallCardData",value:function(){var t=Object(c.a)(r.a.mark((function t(e){var a,n,o,c,i,s,l=arguments;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"",n="https://api.scryfall.com/cards/named?exact=".concat(encodeURI(e),"&set=").concat(a),t.next=4,fetch(n);case 4:return o=t.sent,t.next=7,o.json();case 7:return c=t.sent,t.prev=8,"card_faces"in c&&Object.assign(c,c.card_faces[0]),i=c.colors.join(""),(s=i).length>1?s="M":0===s.length&&(i=s="C"),c.type_line.includes("Land")&&(s="L"),t.abrupt("return",{color_pile:s,colors:i,cmc:c.cmc,imageURL:c.image_uris.normal});case 17:return t.prev=17,t.t0=t.catch(8),console.error("Error parsing card data: ".concat(t.t0,". Card JSON: ").concat(JSON.stringify(c))),t.abrupt("return",{color_pile:"C",colors:"C",cmc:0,imageURL:"https://api.scryfall.com/cards/named?format=image&exact=".concat(e)});case 21:case"end":return t.stop()}}),t,null,[[8,17]])})));return function(e){return t.apply(this,arguments)}}()}]),t}(),T=a(36),A=a.n(T),N=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={showModal:!1},n.handleOpenModal=function(){n.setState({showModal:!0})},n.handleCloseModal=function(){n.setState({showModal:!1})},n}return Object(s.a)(a,[{key:"render",value:function(){return p.a.createElement(p.a.Fragment,null,p.a.createElement("button",{onClick:this.handleOpenModal},"Sample Hand"),p.a.createElement(A.a,{isOpen:this.state.showModal,onRequestClose:this.handleCloseModal,contentLabel:"Sample Hand",style:{overlay:{zIndex:1e3}}},p.a.createElement(R,{maindeckBoardState:this.props.maindeckBoardState}),p.a.createElement("p",null,"(ESC or click outside to close)")))}}]),a}(p.a.Component);var R=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state=n.getNewHandState(),n}return Object(s.a)(a,[{key:"getNewHandState",value:function(){var t,e=function(t){for(var e=t.length-1;e>0;e--){var a=Math.floor(Math.random()*(e+1)),n=[t[a],t[e]];t[e]=n[0],t[a]=n[1]}return t}(this.props.maindeckBoardState.getCards()),a=[],n=Math.min(7,e.length),r=Object(o.a)(Array(n));try{for(r.s();!(t=r.n()).done;){t.value;a.push(e.pop())}}catch(c){r.e(c)}finally{r.f()}return{shuffledDeck:e,hand:a}}},{key:"drawCard",value:function(){this.state.shuffledDeck.length>0&&(this.state.hand.push(this.state.shuffledDeck.pop()),this.setState({}))}},{key:"render",value:function(){var t=this,e=this.state.hand.map((function(t){return t.data.imageURL})).map((function(t){return p.a.createElement("img",{src:t,width:146,height:204})}));return p.a.createElement(p.a.Fragment,null,p.a.createElement("button",{onClick:function(){return t.drawCard()}},"Draw card"),p.a.createElement("button",{onClick:function(){return t.setState(t.getNewHandState())}},"New hand"),p.a.createElement("div",null,e))}}]),a}(p.a.Component),_=["Battle Hymn","Reaper King","Death or Glory","Mindless Automaton","Wizard Mentor","Crow Storm","Gaea's Touch"].join("\n");function P(t){var e=Object(y.a)({item:{type:"Card",card:t.card},collect:function(t){return{isDragging:t.isDragging()}}}),a=Object(h.a)(e,2),n=a[0].isDragging,r=a[1],o=t.card.data?t.card.data.imageURL:"",c=Object(m.useState)(!1),i=Object(h.a)(c,2),s=i[0],l=i[1],u=s&&!n?"visible":"hidden";return[p.a.createElement("img",{ref:r,src:o,width:146,height:204,onClick:function(){return t.moveCardToOtherBoard(t.card)},onMouseMove:function(t){return!s&&l(!0)},onMouseLeave:function(){return l(!1)},style:{position:"absolute",top:"".concat(t.top,"px"),left:"".concat(t.left,"px"),zIndex:"".concat(t.zIndex)}}),p.a.createElement("img",{src:o,width:292,height:408,style:{visibility:u,position:"absolute",top:"".concat(t.top,"px"),left:"".concat(t.left+146,"px"),zIndex:999}})]}function z(t){for(var e=Object(S.a)({accept:"Card",drop:function(e,a){return H(t.boardState,a.getClientOffset(),e.card)},collect:function(t){return{mousePos:t.getClientOffset()}}}),a=Object(h.a)(e,2),n=(a[0].mousePos,a[1]),r=[],o=t.boardState.cardColumns,c=0;c<o.length;c++)for(var i=0;i<o[c].length;i++){var s=o[c][i],l=25*i,u=147*c;r.push(p.a.createElement(P,{key:s.id.toString(),card:s,top:l,left:u,zIndex:i,moveCardToOtherBoard:t.moveCardToOtherBoard}))}var d=147*t.boardState.numCols;return p.a.createElement("div",{ref:n,className:"card-space",style:{position:"relative",width:"".concat(d,"px")}},r,p.a.createElement("div",{style:{position:"absolute",bottom:"5px",right:"5px"}},t.boardState.numCards()," cards"))}var H=function(t,e,a){var n=Math.min(Math.floor(e.x/147),t.numCols-1),r=Math.floor(e.y/25);t.moveCard(a,n,r)};function U(t){return p.a.createElement("input",{type:"button",onClick:function(){return t.topLevelContainer.setState({boardState:t.topLevelContainer.state.boardState.sortByCmc()})},value:"Sort by CMC"})}function F(t){return p.a.createElement("input",{type:"button",onClick:function(){return t.topLevelContainer.setState({boardState:t.topLevelContainer.state.boardState.sortByColor()})},value:"Sort by Color"})}function J(t){return p.a.createElement("div",{style:{float:"right"}},"Large space is the maindeck, smaller space is the sideboard. ",p.a.createElement("br",null),"Drag and drop to move cards around. ",p.a.createElement("br",null),"Click a card to move it from the maindeck to sideboard or vice versa. ",p.a.createElement("br",null),'Multiple formats are supported for "Load cards", including MTG Arena. ',p.a.createElement("br",null),"Valid example lines: ",p.a.createElement("br",null),"Wizard Mentor ",p.a.createElement("br",null),"1 Battle Hymn ",p.a.createElement("br",null),"5 Forest ",p.a.createElement("br",null),"1 Cogwork Assembler (AER) 145 ",p.a.createElement("br",null),"1 Songs of the Damned (ME2)")}var G=function(){var t=new URLSearchParams(window.location.search).get("cards");return t?window.atob(t):_},W=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var n;Object(i.a)(this,a),n=e.call(this,t);var r=new I,o=w(G()),c=Object(h.a)(o,2),s=c[0],u=c[1];return n.state={cardLoader:r,boardState:new O(r,s,8,Object(l.a)(n)),sideboardState:new O(r,u,1,Object(l.a)(n))},n}return Object(s.a)(a,[{key:"moveCardToOtherBoard",value:function(t,e,a){e.removeCard(t),a.addCard(t),this.setState({})}},{key:"addLand",value:function(){var t=Object(c.a)(r.a.mark((function t(e,a){var n,c,i,s,l,u,d=arguments;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=d.length>2&&void 0!==d[2]?d[2]:"",c=this.state.boardState,i=this.state.cardLoader,s=Object(o.a)(Array(a)),t.prev=4,s.s();case 6:if((l=s.n()).done){t.next=14;break}return l.value,t.next=10,i.getCardData(e,n);case 10:u=t.sent,c.addCard(u);case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),s.e(t.t0);case 19:return t.prev=19,s.f(),t.finish(19);case 22:this.setState({});case 23:case"end":return t.stop()}}),t,this,[[4,16,19,22]])})));return function(e,a){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return p.a.createElement("div",null,p.a.createElement(z,{boardState:this.state.boardState,moveCardToOtherBoard:function(e){t.moveCardToOtherBoard(e,t.state.boardState,t.state.sideboardState)}}),p.a.createElement(z,{boardState:this.state.sideboardState,moveCardToOtherBoard:function(e){t.moveCardToOtherBoard(e,t.state.sideboardState,t.state.boardState)}}),p.a.createElement(E,{id:"card-pool-input",initialText:G()}),p.a.createElement(j,{inputElementId:"card-pool-input",topLevelContainer:this}),p.a.createElement(U,{topLevelContainer:this}),p.a.createElement(F,{topLevelContainer:this}),p.a.createElement(M,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),p.a.createElement(B,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),p.a.createElement(N,{maindeckBoardState:this.state.boardState}),p.a.createElement(D,{addLand:function(e,a,n){return t.addLand(e,a,n)}}),p.a.createElement(J,null))}}]),a}(p.a.Component);v.a.render(p.a.createElement(b.a,{options:C.a},p.a.createElement(W,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.2e06a5c4.chunk.js.map