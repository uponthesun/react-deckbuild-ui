(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{41:function(e,t,a){e.exports=a(60)},50:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),o=a(4),c=a(9),i=a(7),s=a(8),l=a(19),u=a(13),d=a(14),h=a(11),m=a(0),p=a.n(m),f=a(17),v=a.n(f),b=a(38),C=a(37),y=a(63),S=a(64),g=(a(50),a(16)),O=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(i.a)(this,e),this.cardLoader=t,this.numCols=n,this.loadCardPool(a,r)}return Object(s.a)(e,[{key:"loadCardPool",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cardColumns=Object(g.a)(Array(this.numCols)).map((function(e){return[]})),n=Object(o.a)(t);try{for(n.s();!(c=n.n()).done;)i=c.value,this.createAndAddCards(i).then((function(e){a&&a.setState({})}))}catch(r){n.e(r)}finally{n.f()}case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"createAndAddCards",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.quantity)){e.next=11;break}return e.next=4,this.cardLoader.getCardData(t.name,t.set);case 4:(o=e.sent).currentBoard=this,this.cardColumns[0].push(o),a=o;case 8:n++,e.next=1;break;case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addCard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(!a||a>this.cardColumns[t].length)&&(a=this.cardColumns[t].length),this.cardColumns[t].splice(a,0,e),e.currentBoard=this}},{key:"removeCard",value:function(e){for(var t=0;t<this.cardColumns.length;t++)for(var a=this.cardColumns[t],n=0;n<a.length;n++)if(a[n].id===e.id)return a.splice(n,1),e;throw"Tried to remove card, but it wasn't in this board: "+JSON.stringify(e)}},{key:"moveCard",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentBoard.removeCard(t),this.addCard(t,a,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"numCards",value:function(){return this.cardColumns.flat().length}},{key:"getCards",value:function(){return this.cardColumns.flat()}},{key:"sortByCmc",value:function(){var e,t=Object(g.a)(Array(this.numCols)).map((function(e){return[]})),a=Object(o.a)(this.cardColumns.flat());try{for(a.s();!(e=a.n()).done;){var n=e.value;t[Math.min(n.data.cmc,7)].push(n)}}catch(i){a.e(i)}finally{a.f()}var r,c=Object(o.a)(t);try{for(c.s();!(r=c.n()).done;){r.value.sort((function(e,t){return e.name.localeCompare(t.name)}))}}catch(i){c.e(i)}finally{c.f()}return this.cardColumns=t,this}},{key:"sortByColor",value:function(){var e=Object(g.a)(Array(this.numCols)).map((function(e){return[]})),t=["L","W","U","B","R","G","C","M"],a=this.cardColumns.flat().filter((function(e){return"M"!==e.data.color_pile})),n=this.cardColumns.flat().filter((function(e){return"M"===e.data.color_pile}));n.sort((function(e,t){return e.data.colors.localeCompare(t.data.colors)}));for(var r=0,c=[].concat(Object(g.a)(a),Object(g.a)(n));r<c.length;r++){var i=c[r];e[t.indexOf(i.data.color_pile)].push(i)}var s,l=Object(o.a)(e);try{for(l.s();!(s=l.n()).done;){s.value.sort((function(e,t){return e.name.localeCompare(t.name)}))}}catch(u){l.e(u)}finally{l.f()}return this.cardColumns=e,this}},{key:"asText",value:function(e){var t,a=function(t){var a=t.name;return e&&t.set&&(a+=" (".concat(t.set,")")),a},n={},r=Object(o.a)(this.cardColumns.flat());try{for(r.s();!(t=r.n()).done;){var c=a(t.value);n.hasOwnProperty(c)||(n[c]=0),n[c]++}}catch(i){r.e(i)}finally{r.f()}return Object.entries(n).map((function(e){return"".concat(e[1]," ").concat(e[0])})).join("\n")}}]),e}(),E=function(e){return p.a.createElement("textarea",{id:e.id,rows:"5",cols:"33"},e.initialText)},k=function(e){var t,a=e.split("\n").filter((function(e){return e.trim().length>0})),n=[[],[]],r=n[0],c=Object(o.a)(a);try{for(c.s();!(t=c.n()).done;){var i=t.value;i.includes("Sideboard")?r=n[1]:r.push(w(i))}}catch(s){c.e(s)}finally{c.f()}return n},w=function(e){var t,a,n,r=e.split("("),o=Object(h.a)(r,2),c=o[0],i=o[1];if(n=c[0],Number.isNaN(Number(n)))t=1,a=c.trim();else{var s=c.indexOf(" "),l=c.substring(0,s);l.endsWith("x")&&(l=l.slice(0,-1)),t=Number(l),a=c.substring(s).trim()}var u="";return i&&(u=i.split(")")[0].trim()),{name:a,quantity:t,set:u}},j=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"load",value:function(){var e=document.getElementById(this.props.inputElementId).value,t=k(e),a=Object(h.a)(t,2),n=a[0],r=a[1],o=this.props.topLevelContainer.state.boardState.numCols,c=this.props.topLevelContainer.state.cardLoader;this.props.topLevelContainer.setState({boardState:new O(c,n,o,this.props.topLevelContainer),sideboardState:new O(c,r,1,this.props.topLevelContainer)})}},{key:"render",value:function(){var e=this;return p.a.createElement("input",{type:"button",onClick:function(){return e.load()},value:"Load cards"})}}]),a}(p.a.Component),x=function(e,t,a){return e.asText(a)+"\n\n// Sideboard\n"+t.asText(a)},L=function(e){navigator.clipboard.writeText(e).then((function(){return alert("Copied to clipboard:\n\n".concat(e))}),(function(){return alert("Failed to copy to clipboard")}))},M=function(e){return p.a.createElement("input",{type:"button",onClick:function(){var t=x(e.boardState,e.sideboardState,!1);L(t)},value:"Export to Cockatrice"})},B=function(e){return p.a.createElement("input",{type:"button",onClick:function(){var t=window.btoa(x(e.boardState,e.sideboardState,!0));window.history.replaceState({},"","?cards=".concat(t)),L(window.location.href)},value:"Copy Link"})};function D(e){var t=e.id+"-selector",a=e.id+"-input-count";return p.a.createElement("div",null,p.a.createElement("select",{id:t},p.a.createElement("option",{value:"Snow-Covered Plains"},"Snow-Covered Plains"),p.a.createElement("option",{value:"Snow-Covered Island"},"Snow-Covered Island"),p.a.createElement("option",{value:"Snow-Covered Swamp"},"Snow-Covered Swamp"),p.a.createElement("option",{value:"Snow-Covered Mountain"},"Snow-Covered Mountain"),p.a.createElement("option",{value:"Snow-Covered Forest"},"Snow-Covered Forest")),p.a.createElement("input",{type:"number",min:"0",max:"20",placeholder:"1",id:a}),p.a.createElement("input",{type:"button",onClick:function(){var n=document.getElementById(t).value,r=parseInt(document.getElementById(a).value)||1;e.addLand(n,r,"ICE")},value:"Add Basic Lands"}))}var I=function(){function e(){Object(i.a)(this,e),this.nextId=0,this.cardDataCache={}}return Object(s.a)(e,[{key:"getCardData",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.length>1&&void 0!==o[1]?o[1]:"",n={name:t,set:a,id:this.nextId},this.nextId++,this.cardDataCache[t]||(this.cardDataCache[t]={}),this.cardDataCache[t][a]){e.next=8;break}return e.next=7,this.getScryfallCardData(t,a);case 7:this.cardDataCache[t][a]=e.sent;case 8:return n.data=this.cardDataCache[t][a],e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScryfallCardData",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o,c,i,s,l=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"",n="https://api.scryfall.com/cards/named?exact=".concat(encodeURI(t),"&set=").concat(a),e.next=4,fetch(n);case 4:return o=e.sent,e.next=7,o.json();case 7:return c=e.sent,e.prev=8,"card_faces"in c&&Object.assign(c,c.card_faces[0]),i=c.colors.join(""),(s=i).length>1?s="M":0===s.length&&(i=s="C"),c.type_line.includes("Land")&&(s="L"),e.abrupt("return",{color_pile:s,colors:i,cmc:c.cmc,imageURL:c.image_uris.normal});case 17:return e.prev=17,e.t0=e.catch(8),console.error("Error parsing card data: ".concat(e.t0,". Card JSON: ").concat(JSON.stringify(c))),e.abrupt("return",{color_pile:"C",colors:"C",cmc:0,imageURL:"https://api.scryfall.com/cards/named?format=image&exact=".concat(t)});case 21:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T=a(39),A=a(36),N=a.n(A),R=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={showModal:!1},n.handleOpenModal=function(){n.setState({showModal:!0})},n.handleCloseModal=function(){n.setState({showModal:!1})},n}return Object(s.a)(a,[{key:"render",value:function(){return p.a.createElement(p.a.Fragment,null,p.a.createElement("button",{onClick:this.handleOpenModal},"Sample Hand"),p.a.createElement(N.a,{isOpen:this.state.showModal,onRequestClose:this.handleCloseModal,contentLabel:"Sample Hand",style:{overlay:{zIndex:1e3}}},p.a.createElement(_,{maindeckBoardState:this.props.maindeckBoardState}),p.a.createElement("p",null,"(ESC or click outside to close)")))}}]),a}(p.a.Component);var _=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state=Object(T.a)({},n.getNewHandState(),{lockedCard:""}),n}return Object(s.a)(a,[{key:"getNewHandState",value:function(){var e=this,t=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}(this.props.maindeckBoardState.getCards()),a=[];if(this.state&&this.state.lockedCard){var n=t.findIndex((function(t){return t.name==e.state.lockedCard}));a.push(t[n]),t.splice(n,1)}var r,c=Math.min(7-a.length,t.length),i=Object(o.a)(Array(c));try{for(i.s();!(r=i.n()).done;){r.value;a.push(t.pop())}}catch(s){i.e(s)}finally{i.f()}return{shuffledDeck:t,hand:a}}},{key:"drawCard",value:function(){this.state.shuffledDeck.length>0&&(this.state.hand.push(this.state.shuffledDeck.pop()),this.setState({}))}},{key:"handleChange",value:function(e){this.setState({lockedCard:e.target.value})}},{key:"render",value:function(){var e=this,t=this.state.hand.map((function(e){return e.data.imageURL})).map((function(e){return p.a.createElement("img",{src:e,width:146,height:204})})),a=Array.from(new Set(this.props.maindeckBoardState.getCards().map((function(e){return e.name})))).sort().map((function(e){return p.a.createElement("option",{value:e},e)}));return p.a.createElement(p.a.Fragment,null,p.a.createElement("button",{onClick:function(){return e.drawCard()}},"Draw card"),p.a.createElement("button",{onClick:function(){return e.setState(e.getNewHandState())}},"New hand"),p.a.createElement("select",{id:"reserved-card-select",onChange:function(t){return e.handleChange(t)},tabindex:"-1"},p.a.createElement("option",{value:""},"-- Lock a card into opening hand --"),a),p.a.createElement("div",null,t))}}]),a}(p.a.Component),P=["Battle Hymn","Reaper King","Death or Glory","Mindless Automaton","Wizard Mentor","Crow Storm","Gaea's Touch"].join("\n");function z(e){var t=Object(y.a)({item:{type:"Card",card:e.card},collect:function(e){return{isDragging:e.isDragging()}}}),a=Object(h.a)(t,2),n=a[0].isDragging,r=a[1],o=e.card.data?e.card.data.imageURL:"",c=Object(m.useState)(!1),i=Object(h.a)(c,2),s=i[0],l=i[1],u=s&&!n?"visible":"hidden";return[p.a.createElement("img",{ref:r,src:o,width:146,height:204,onClick:function(){return e.moveCardToOtherBoard(e.card)},onMouseMove:function(e){return!s&&l(!0)},onMouseLeave:function(){return l(!1)},style:{position:"absolute",top:"".concat(e.top,"px"),left:"".concat(e.left,"px"),zIndex:"".concat(e.zIndex)}}),p.a.createElement("img",{src:o,width:292,height:408,style:{visibility:u,position:"absolute",top:"".concat(e.top,"px"),left:"".concat(e.left+146,"px"),zIndex:999}})]}function H(e){for(var t=Object(S.a)({accept:"Card",drop:function(t,a){return U(e.boardState,a.getClientOffset(),t.card)},collect:function(e){return{mousePos:e.getClientOffset()}}}),a=Object(h.a)(t,2),n=(a[0].mousePos,a[1]),r=[],o=e.boardState.cardColumns,c=0;c<o.length;c++)for(var i=0;i<o[c].length;i++){var s=o[c][i],l=25*i,u=147*c;r.push(p.a.createElement(z,{key:s.id.toString(),card:s,top:l,left:u,zIndex:i,moveCardToOtherBoard:e.moveCardToOtherBoard}))}var d=147*e.boardState.numCols;return p.a.createElement("div",{ref:n,className:"card-space",style:{position:"relative",width:"".concat(d,"px")}},r,p.a.createElement("div",{style:{position:"absolute",bottom:"5px",right:"5px"}},e.boardState.numCards()," cards"))}var U=function(e,t,a){var n=Math.min(Math.floor(t.x/147),e.numCols-1),r=Math.floor(t.y/25);e.moveCard(a,n,r)};function F(e){return p.a.createElement("input",{type:"button",onClick:function(){return e.topLevelContainer.setState({boardState:e.topLevelContainer.state.boardState.sortByCmc()})},value:"Sort by CMC"})}function J(e){return p.a.createElement("input",{type:"button",onClick:function(){return e.topLevelContainer.setState({boardState:e.topLevelContainer.state.boardState.sortByColor()})},value:"Sort by Color"})}function G(e){return p.a.createElement("div",{style:{float:"right"}},"Large space is the maindeck, smaller space is the sideboard. ",p.a.createElement("br",null),"Drag and drop to move cards around. ",p.a.createElement("br",null),"Click a card to move it from the maindeck to sideboard or vice versa. ",p.a.createElement("br",null),'Multiple formats are supported for "Load cards", including MTG Arena. ',p.a.createElement("br",null),"Valid example lines: ",p.a.createElement("br",null),"Wizard Mentor ",p.a.createElement("br",null),"1 Battle Hymn ",p.a.createElement("br",null),"5 Forest ",p.a.createElement("br",null),"1 Cogwork Assembler (AER) 145 ",p.a.createElement("br",null),"1 Songs of the Damned (ME2)")}var W=function(){var e=new URLSearchParams(window.location.search).get("cards");return e?window.atob(e):P},q=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(i.a)(this,a),n=t.call(this,e);var r=new I,o=k(W()),c=Object(h.a)(o,2),s=c[0],u=c[1];return n.state={cardLoader:r,boardState:new O(r,s,8,Object(l.a)(n)),sideboardState:new O(r,u,1,Object(l.a)(n))},n}return Object(s.a)(a,[{key:"moveCardToOtherBoard",value:function(e,t,a){t.removeCard(e),a.addCard(e),this.setState({})}},{key:"addLand",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c,i,s,l,u,d=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.length>2&&void 0!==d[2]?d[2]:"",c=this.state.boardState,i=this.state.cardLoader,s=Object(o.a)(Array(a)),e.prev=4,s.s();case 6:if((l=s.n()).done){e.next=14;break}return l.value,e.next=10,i.getCardData(t,n);case 10:u=e.sent,c.addCard(u);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),s.e(e.t0);case 19:return e.prev=19,s.f(),e.finish(19);case 22:this.setState({});case 23:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return p.a.createElement("div",null,p.a.createElement(H,{boardState:this.state.boardState,moveCardToOtherBoard:function(t){e.moveCardToOtherBoard(t,e.state.boardState,e.state.sideboardState)}}),p.a.createElement(H,{boardState:this.state.sideboardState,moveCardToOtherBoard:function(t){e.moveCardToOtherBoard(t,e.state.sideboardState,e.state.boardState)}}),p.a.createElement(E,{id:"card-pool-input",initialText:W()}),p.a.createElement(j,{inputElementId:"card-pool-input",topLevelContainer:this}),p.a.createElement(F,{topLevelContainer:this}),p.a.createElement(J,{topLevelContainer:this}),p.a.createElement(M,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),p.a.createElement(B,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),p.a.createElement(R,{maindeckBoardState:this.state.boardState}),p.a.createElement(D,{addLand:function(t,a,n){return e.addLand(t,a,n)}}),p.a.createElement(G,null))}}]),a}(p.a.Component);v.a.render(p.a.createElement(b.a,{options:C.a},p.a.createElement(q,null)),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.ba39d1c2.chunk.js.map