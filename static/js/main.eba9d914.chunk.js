(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{30:function(t,e,a){t.exports=a(38)},35:function(t,e,a){},38:function(t,e,a){"use strict";a.r(e);var r=a(4),n=a(5),o=a(17),c=a(18),i=a(10),l=a(0),u=a.n(l),s=a(25),d=a.n(s),m=a(27),p=a(40),f=a(42),v=a(41),h=(a(35),a(15)),b=a(3),C=a.n(b),y=a(11),S=a(8),g=function(){function t(e,a,n){Object(r.a)(this,t),this.cardLoader=e,a||(a=[]),this.numCols=n,this.loadCardPool(a)}return Object(n.a)(t,[{key:"loadCardPool",value:function(){var t=Object(S.a)(C.a.mark((function t(e){var a=this;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.cardColumns=Object(y.a)(Array(this.numCols)).map((function(t){return[]})),e.forEach((function(t){return a.createAndAddCard(t)}));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createAndAddCard",value:function(){var t=Object(S.a)(C.a.mark((function t(e){var a;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=this.cardLoader.getCardData(e)).currentBoard=this,this.cardColumns[0].push(a),t.abrupt("return",a);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"addCard",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(!a||a>this.cardColumns[e].length)&&(a=this.cardColumns[e].length),this.cardColumns[e].splice(a,0,t),t.currentBoard=this}},{key:"removeCard",value:function(t){for(var e=0;e<this.cardColumns.length;e++)for(var a=this.cardColumns[e],r=0;r<a.length;r++)if(a[r].id===t.id)return a.splice(r,1),t;throw"Tried to remove card, but it wasn't in this board: "+JSON.stringify(t)}},{key:"moveCard",value:function(){var t=Object(S.a)(C.a.mark((function t(e,a,r){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.currentBoard.removeCard(e),this.addCard(e,a,r);case 2:case"end":return t.stop()}}),t,this)})));return function(e,a,r){return t.apply(this,arguments)}}()},{key:"numCards",value:function(){return this.cardColumns.flat().length}},{key:"sortByCmc",value:function(){var t,e=Object(y.a)(Array(this.numCols)).map((function(t){return[]})),a=Object(h.a)(this.cardColumns.flat());try{for(a.s();!(t=a.n()).done;){var r=t.value;e[Math.min(r.data.cmc,7)].push(r)}}catch(n){a.e(n)}finally{a.f()}return this.cardColumns=e,this}},{key:"sortByColor",value:function(){var t=Object(y.a)(Array(this.numCols)).map((function(t){return[]})),e=["L","W","U","B","R","G","C","M"],a=this.cardColumns.flat().filter((function(t){return"M"!==t.data.color_pile})),r=this.cardColumns.flat().filter((function(t){return"M"===t.data.color_pile}));r.sort((function(t,e){return t.data.colors.localeCompare(e.data.colors)}));for(var n=0,o=[].concat(Object(y.a)(a),Object(y.a)(r));n<o.length;n++){var c=o[n];t[e.indexOf(c.data.color_pile)].push(c)}return this.cardColumns=t,this}}]),t}(),E=function(t){return u.a.createElement("textarea",{id:t.id,rows:"5",cols:"33"})},O=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(n.a)(a,[{key:"inputToCardNames",value:function(t){var e,a,r=t.split("\n").filter((function(t){return t.trim().length>0})),n=[],o=[],c=n,i=Object(h.a)(r);try{for(i.s();!(e=i.n()).done;){var l=e.value;if(l.includes("Sideboard"))c=o;else{l=l.split("(")[0].trim();var u=1;if(a=l[0],!Number.isNaN(Number(a))){var s=l.indexOf(" "),d=l.substring(0,s);d.endsWith("x")&&(d=d.slice(0,-1)),u=Number(d),l=l.substring(s).trim()}for(var m=0;m<u;m++)c.push(l)}}}catch(p){i.e(p)}finally{i.f()}return[n,o]}},{key:"load",value:function(){var t=document.getElementById(this.props.inputElementId).value,e=this.inputToCardNames(t),a=Object(i.a)(e,2),r=a[0],n=a[1],o=this.props.topLevelContainer.state.boardState.numCols,c=this.props.topLevelContainer.state.cardLoader;this.props.topLevelContainer.setState({boardState:new g(c,r,o),sideboardState:new g(c,n,1)})}},{key:"render",value:function(){var t=this;return u.a.createElement("input",{type:"button",onClick:function(){return t.load()},value:"Load cards"})}}]),a}(u.a.Component),w=function(t){return u.a.createElement("input",{type:"button",onClick:function(){var e,a,r,n=(e=t.boardState.cardColumns.flat(),a=t.sideboardState.cardColumns.flat(),e.map((function(t){return t.name})).join("\n")+"\n\n// Sideboard\n"+a.map((function(t){return t.name})).join("\n"));r=n,navigator.clipboard.writeText(r).then((function(){return alert("Copied to clipboard:\n\n".concat(r))}),(function(){return alert("Failed to copy to clipboard")}))},value:"Export to Cockatrice"})};function j(t){var e=t.id+"-selector",a=t.id+"-input-count";return u.a.createElement("div",null,u.a.createElement("select",{id:e},u.a.createElement("option",{value:"Snow-Covered Plains"},"Snow-Covered Plains"),u.a.createElement("option",{value:"Snow-Covered Island"},"Snow-Covered Island"),u.a.createElement("option",{value:"Snow-Covered Swamp"},"Snow-Covered Swamp"),u.a.createElement("option",{value:"Snow-Covered Mountain"},"Snow-Covered Mountain"),u.a.createElement("option",{value:"Snow-Covered Forest"},"Snow-Covered Forest")),u.a.createElement("input",{type:"number",min:"0",max:"20",placeholder:"1",id:a}),u.a.createElement("input",{type:"button",onClick:function(){var r=document.getElementById(e).value,n=parseInt(document.getElementById(a).value)||1;t.addLand(r,n)},value:"Add Basic Lands"}))}var k=function(){function t(){Object(r.a)(this,t),this.nextId=0}return Object(n.a)(t,[{key:"getCardData",value:function(t){var e={name:t,id:this.nextId};return this.nextId++,this.getCardDataAsync(t).then((function(t){return e.data=t})),e}},{key:"getCardDataAsync",value:function(){var t=Object(S.a)(C.a.mark((function t(e){var a,r,n,o,c;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="https://api.scryfall.com/cards/named?exact=".concat(encodeURI(e)),t.next=3,fetch(a);case 3:return r=t.sent,t.next=6,r.json();case 6:return n=t.sent,t.prev=7,"card_faces"in n&&Object.assign(n,n.card_faces[0]),o=n.colors.join(""),(c=o).length>1?c="M":0===c.length&&(o=c="C"),n.type_line.includes("Land")&&(c="L"),t.abrupt("return",{color_pile:c,colors:o,cmc:n.cmc});case 16:throw t.prev=16,t.t0=t.catch(7),console.error("Error parsing card data: ".concat(t.t0,". Card JSON: ").concat(JSON.stringify(n))),t.t0;case 20:case"end":return t.stop()}}),t,null,[[7,16]])})));return function(e){return t.apply(this,arguments)}}()}]),t}(),x=["Battle Hymn","Reaper King","Death or Glory","Mindless Automaton","Wizard Mentor","Crow Storm","Gaea's Touch"];function L(t){var e=Object(f.a)({item:{type:"Card",card:t.card},collect:function(t){return{isDragging:t.isDragging()}}}),a=Object(i.a)(e,2),r=a[0].isDragging,n=a[1],o="https://api.scryfall.com/cards/named?format=image&exact=".concat(encodeURI(t.card.name)),c=Object(l.useState)(!1),s=Object(i.a)(c,2),d=s[0],m=s[1],p=d&&!r?"visible":"hidden";return[u.a.createElement("img",{ref:n,src:o,width:146,height:204,onDoubleClick:function(){return t.moveCardToOtherBoard(t.card)},onMouseMove:function(t){return!d&&m(!0)},onMouseLeave:function(){return m(!1)},style:{position:"absolute",top:"".concat(t.top,"px"),left:"".concat(t.left,"px"),zIndex:"".concat(t.zIndex)}}),u.a.createElement("img",{src:o,width:292,height:408,style:{visibility:p,position:"absolute",top:"".concat(t.top,"px"),left:"".concat(t.left+146,"px"),zIndex:999}})]}function B(t){for(var e=Object(v.a)({accept:"Card",drop:function(e,a){return M(t.boardState,a.getClientOffset(),e.card)},collect:function(t){return{mousePos:t.getClientOffset()}}}),a=Object(i.a)(e,2),r=(a[0].mousePos,a[1]),n=[],o=t.boardState.cardColumns,c=0;c<o.length;c++)for(var l=0;l<o[c].length;l++){var s=o[c][l],d=25*l,m=147*c;n.push(u.a.createElement(L,{key:s.id.toString(),card:s,top:d,left:m,zIndex:l,moveCardToOtherBoard:t.moveCardToOtherBoard}))}var p=147*t.boardState.numCols;return u.a.createElement("div",{ref:r,className:"card-space",style:{position:"relative",width:"".concat(p,"px")}},n,u.a.createElement("div",{style:{position:"absolute",bottom:"5px",right:"5px"}},t.boardState.numCards()," cards"))}var M=function(t,e,a){var r=Math.min(Math.floor(e.x/147),t.numCols-1),n=Math.floor(e.y/25);t.moveCard(a,r,n)};function I(t){return u.a.createElement("input",{type:"button",onClick:function(){return t.topLevelContainer.setState({boardState:t.topLevelContainer.state.boardState.sortByCmc()})},value:"Sort by CMC"})}function A(t){return u.a.createElement("input",{type:"button",onClick:function(){return t.topLevelContainer.setState({boardState:t.topLevelContainer.state.boardState.sortByColor()})},value:"Sort by Color"})}function T(t){return u.a.createElement("div",{style:{float:"right"}},"Large space is the maindeck, smaller space is the sideboard. ",u.a.createElement("br",null),"Drag and drop to move cards around. ",u.a.createElement("br",null),"Double-click a card to move it from the maindeck to sideboard or vice versa. ",u.a.createElement("br",null),'Multiple formats are supported for "Load cards", including MTG Arena. ',u.a.createElement("br",null),"Valid example lines: ",u.a.createElement("br",null),"Wizard Mentor ",u.a.createElement("br",null),"1 Battle Hymn ",u.a.createElement("br",null),"5 Forest ",u.a.createElement("br",null),"1 Cogwork Assembler (AER) 145")}var D=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(t){var n;Object(r.a)(this,a),n=e.call(this,t);var o=new k;return n.state={cardLoader:o,boardState:new g(o,x,8),sideboardState:new g(o,[],1)},n}return Object(n.a)(a,[{key:"moveCardToOtherBoard",value:function(t,e,a){e.removeCard(t),a.addCard(t),this.setState(this.state)}},{key:"addLand",value:function(t,e){var a=this.state.boardState,r=this.state.cardLoader;Array(e).fill(null).forEach((function(){var e=r.getCardData(t);a.addCard(e)})),this.setState(this.state)}},{key:"render",value:function(){var t=this;return u.a.createElement("div",null,u.a.createElement(B,{boardState:this.state.boardState,moveCardToOtherBoard:function(e){t.moveCardToOtherBoard(e,t.state.boardState,t.state.sideboardState)}}),u.a.createElement(B,{boardState:this.state.sideboardState,moveCardToOtherBoard:function(e){t.moveCardToOtherBoard(e,t.state.sideboardState,t.state.boardState)}}),u.a.createElement(E,{id:"card-pool-input"}),u.a.createElement(O,{inputElementId:"card-pool-input",topLevelContainer:this}),u.a.createElement(I,{topLevelContainer:this}),u.a.createElement(A,{topLevelContainer:this}),u.a.createElement(w,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),u.a.createElement(j,{addLand:function(e,a){return t.addLand(e,a)}}),u.a.createElement(T,null))}}]),a}(u.a.Component);d.a.render(u.a.createElement(p.a,{backend:m.a},u.a.createElement(D,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.eba9d914.chunk.js.map