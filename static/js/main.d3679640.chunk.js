(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{37:function(e,t,a){e.exports=a(56)},43:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),o=a(6),c=a(7),i=a(4),s=a(5),l=a(16),u=a(9),d=a(10),h=a(11),p=a(0),m=a.n(p),f=a(24),v=a.n(f),b=a(34),C=a(58),y=a(60),g=a(59),S=(a(43),a(14)),O=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(i.a)(this,e),this.cardLoader=t,this.numCols=n,this.loadCardPool(a,r)}return Object(s.a)(e,[{key:"loadCardPool",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cardColumns=Object(S.a)(Array(this.numCols)).map((function(e){return[]})),n=Object(o.a)(t);try{for(n.s();!(c=n.n()).done;)i=c.value,this.createAndAddCards(i).then((function(e){a&&a.setState({})}))}catch(r){n.e(r)}finally{n.f()}case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"createAndAddCards",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.quantity)){e.next=11;break}return e.next=4,this.cardLoader.getCardData(t.name,t.set);case 4:(o=e.sent).currentBoard=this,this.cardColumns[0].push(o),a=o;case 8:n++,e.next=1;break;case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addCard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(!a||a>this.cardColumns[t].length)&&(a=this.cardColumns[t].length),this.cardColumns[t].splice(a,0,e),e.currentBoard=this}},{key:"removeCard",value:function(e){for(var t=0;t<this.cardColumns.length;t++)for(var a=this.cardColumns[t],n=0;n<a.length;n++)if(a[n].id===e.id)return a.splice(n,1),e;throw"Tried to remove card, but it wasn't in this board: "+JSON.stringify(e)}},{key:"moveCard",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentBoard.removeCard(t),this.addCard(t,a,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"numCards",value:function(){return this.cardColumns.flat().length}},{key:"getCards",value:function(){return this.cardColumns.flat()}},{key:"sortByCmc",value:function(){var e,t=Object(S.a)(Array(this.numCols)).map((function(e){return[]})),a=Object(o.a)(this.cardColumns.flat());try{for(a.s();!(e=a.n()).done;){var n=e.value;t[Math.min(n.data.cmc,7)].push(n)}}catch(r){a.e(r)}finally{a.f()}return this.cardColumns=t,this}},{key:"sortByColor",value:function(){var e=Object(S.a)(Array(this.numCols)).map((function(e){return[]})),t=["L","W","U","B","R","G","C","M"],a=this.cardColumns.flat().filter((function(e){return"M"!==e.data.color_pile})),n=this.cardColumns.flat().filter((function(e){return"M"===e.data.color_pile}));n.sort((function(e,t){return e.data.colors.localeCompare(t.data.colors)}));for(var r=0,o=[].concat(Object(S.a)(a),Object(S.a)(n));r<o.length;r++){var c=o[r];e[t.indexOf(c.data.color_pile)].push(c)}return this.cardColumns=e,this}}]),e}(),E=function(e){return m.a.createElement("textarea",{id:e.id,rows:"5",cols:"33"})},k=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"parseLine",value:function(e){var t,a,n,r=e.split("("),o=Object(h.a)(r,2),c=o[0],i=o[1];if(n=c[0],Number.isNaN(Number(n)))t=1,a=c.trim();else{var s=c.indexOf(" "),l=c.substring(0,s);l.endsWith("x")&&(l=l.slice(0,-1)),t=Number(l),a=c.substring(s).trim()}var u="";return i&&(u=i.split(")")[0].trim()),{name:a,quantity:t,set:u}}},{key:"parseInput",value:function(e){var t,a=e.split("\n").filter((function(e){return e.trim().length>0})),n=[[],[]],r=n[0],c=Object(o.a)(a);try{for(c.s();!(t=c.n()).done;){var i=t.value;i.includes("Sideboard")?r=n[1]:r.push(this.parseLine(i))}}catch(s){c.e(s)}finally{c.f()}return n}},{key:"load",value:function(){var e=document.getElementById(this.props.inputElementId).value,t=this.parseInput(e),a=Object(h.a)(t,2),n=a[0],r=a[1],o=this.props.topLevelContainer.state.boardState.numCols,c=this.props.topLevelContainer.state.cardLoader;this.props.topLevelContainer.setState({boardState:new O(c,n,o,this.props.topLevelContainer),sideboardState:new O(c,r,1,this.props.topLevelContainer)})}},{key:"render",value:function(){var e=this;return m.a.createElement("input",{type:"button",onClick:function(){return e.load()},value:"Load cards"})}}]),a}(m.a.Component),w=function(e){return m.a.createElement("input",{type:"button",onClick:function(){var t,a,n,r=(t=e.boardState.cardColumns.flat(),a=e.sideboardState.cardColumns.flat(),t.map((function(e){return e.name})).join("\n")+"\n\n// Sideboard\n"+a.map((function(e){return e.name})).join("\n"));n=r,navigator.clipboard.writeText(n).then((function(){return alert("Copied to clipboard:\n\n".concat(n))}),(function(){return alert("Failed to copy to clipboard")}))},value:"Export to Cockatrice"})};function j(e){var t=e.id+"-selector",a=e.id+"-input-count";return m.a.createElement("div",null,m.a.createElement("select",{id:t},m.a.createElement("option",{value:"Snow-Covered Plains"},"Snow-Covered Plains"),m.a.createElement("option",{value:"Snow-Covered Island"},"Snow-Covered Island"),m.a.createElement("option",{value:"Snow-Covered Swamp"},"Snow-Covered Swamp"),m.a.createElement("option",{value:"Snow-Covered Mountain"},"Snow-Covered Mountain"),m.a.createElement("option",{value:"Snow-Covered Forest"},"Snow-Covered Forest")),m.a.createElement("input",{type:"number",min:"0",max:"20",placeholder:"1",id:a}),m.a.createElement("input",{type:"button",onClick:function(){var n=document.getElementById(t).value,r=parseInt(document.getElementById(a).value)||1;e.addLand(n,r)},value:"Add Basic Lands"}))}var x=function(){function e(){Object(i.a)(this,e),this.nextId=0,this.cardDataCache={}}return Object(s.a)(e,[{key:"getCardData",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.length>1&&void 0!==o[1]?o[1]:"",n={name:t,id:this.nextId},this.nextId++,this.cardDataCache[t]||(this.cardDataCache[t]={}),this.cardDataCache[t][a]){e.next=8;break}return e.next=7,this.getScryfallCardData(t,a);case 7:this.cardDataCache[t][a]=e.sent;case 8:return n.data=this.cardDataCache[t][a],e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScryfallCardData",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var a,n,o,c,i,s,l=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"",n="https://api.scryfall.com/cards/named?exact=".concat(encodeURI(t),"&set=").concat(a),e.next=4,fetch(n);case 4:return o=e.sent,e.next=7,o.json();case 7:return c=e.sent,e.prev=8,"card_faces"in c&&Object.assign(c,c.card_faces[0]),i=c.colors.join(""),(s=i).length>1?s="M":0===s.length&&(i=s="C"),c.type_line.includes("Land")&&(s="L"),e.abrupt("return",{color_pile:s,colors:i,cmc:c.cmc,imageURL:c.image_uris.normal});case 17:return e.prev=17,e.t0=e.catch(8),console.error("Error parsing card data: ".concat(e.t0,". Card JSON: ").concat(JSON.stringify(c))),e.abrupt("return",{color_pile:"C",colors:"C",cmc:0,imageURL:"https://api.scryfall.com/cards/named?format=image&exact=".concat(t)});case 21:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),L=a(32),M=a.n(L),B=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={showModal:!1},n.handleOpenModal=function(){n.setState({showModal:!0})},n.handleCloseModal=function(){n.setState({showModal:!1})},n}return Object(s.a)(a,[{key:"render",value:function(){return m.a.createElement(m.a.Fragment,null,m.a.createElement("button",{onClick:this.handleOpenModal},"Sample Hand"),m.a.createElement(M.a,{isOpen:this.state.showModal,onRequestClose:this.handleCloseModal,contentLabel:"Sample Hand",style:{overlay:{zIndex:1e3}}},m.a.createElement(D,{maindeckBoardState:this.props.maindeckBoardState}),m.a.createElement("p",null,"(ESC or click outside to close)")))}}]),a}(m.a.Component);var D=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state=n.getNewHandState(),n}return Object(s.a)(a,[{key:"getNewHandState",value:function(){var e,t=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}(this.props.maindeckBoardState.getCards()),a=[],n=Math.min(7,t.length),r=Object(o.a)(Array(n));try{for(r.s();!(e=r.n()).done;){e.value;a.push(t.pop())}}catch(c){r.e(c)}finally{r.f()}return{shuffledDeck:t,hand:a}}},{key:"drawCard",value:function(){this.state.shuffledDeck.length>0&&(this.state.hand.push(this.state.shuffledDeck.pop()),this.setState({}))}},{key:"render",value:function(){var e=this,t=this.state.hand.map((function(e){return e.data.imageURL})).map((function(e){return m.a.createElement("img",{src:e,width:146,height:204})}));return m.a.createElement(m.a.Fragment,null,m.a.createElement("button",{onClick:function(){return e.drawCard()}},"Draw card"),m.a.createElement("button",{onClick:function(){return e.setState(e.getNewHandState())}},"New hand"),m.a.createElement("div",null,t))}}]),a}(m.a.Component),I=["Battle Hymn","Reaper King","Death or Glory","Mindless Automaton","Wizard Mentor","Crow Storm","Gaea's Touch"].map((function(e){return{name:e,quantity:1,set:""}}));function A(e){var t=Object(y.a)({item:{type:"Card",card:e.card},collect:function(e){return{isDragging:e.isDragging()}}}),a=Object(h.a)(t,2),n=a[0].isDragging,r=a[1],o=e.card.data?e.card.data.imageURL:"",c=Object(p.useState)(!1),i=Object(h.a)(c,2),s=i[0],l=i[1],u=s&&!n?"visible":"hidden";return[m.a.createElement("img",{ref:r,src:o,width:146,height:204,onDoubleClick:function(){return e.moveCardToOtherBoard(e.card)},onMouseMove:function(e){return!s&&l(!0)},onMouseLeave:function(){return l(!1)},style:{position:"absolute",top:"".concat(e.top,"px"),left:"".concat(e.left,"px"),zIndex:"".concat(e.zIndex)}}),m.a.createElement("img",{src:o,width:292,height:408,style:{visibility:u,position:"absolute",top:"".concat(e.top,"px"),left:"".concat(e.left+146,"px"),zIndex:999}})]}function N(e){for(var t=Object(g.a)({accept:"Card",drop:function(t,a){return T(e.boardState,a.getClientOffset(),t.card)},collect:function(e){return{mousePos:e.getClientOffset()}}}),a=Object(h.a)(t,2),n=(a[0].mousePos,a[1]),r=[],o=e.boardState.cardColumns,c=0;c<o.length;c++)for(var i=0;i<o[c].length;i++){var s=o[c][i],l=25*i,u=147*c;r.push(m.a.createElement(A,{key:s.id.toString(),card:s,top:l,left:u,zIndex:i,moveCardToOtherBoard:e.moveCardToOtherBoard}))}var d=147*e.boardState.numCols;return m.a.createElement("div",{ref:n,className:"card-space",style:{position:"relative",width:"".concat(d,"px")}},r,m.a.createElement("div",{style:{position:"absolute",bottom:"5px",right:"5px"}},e.boardState.numCards()," cards"))}var T=function(e,t,a){var n=Math.min(Math.floor(t.x/147),e.numCols-1),r=Math.floor(t.y/25);e.moveCard(a,n,r)};function R(e){return m.a.createElement("input",{type:"button",onClick:function(){return e.topLevelContainer.setState({boardState:e.topLevelContainer.state.boardState.sortByCmc()})},value:"Sort by CMC"})}function _(e){return m.a.createElement("input",{type:"button",onClick:function(){return e.topLevelContainer.setState({boardState:e.topLevelContainer.state.boardState.sortByColor()})},value:"Sort by Color"})}function z(e){return m.a.createElement("div",{style:{float:"right"}},"Large space is the maindeck, smaller space is the sideboard. ",m.a.createElement("br",null),"Drag and drop to move cards around. ",m.a.createElement("br",null),"Double-click a card to move it from the maindeck to sideboard or vice versa. ",m.a.createElement("br",null),'Multiple formats are supported for "Load cards", including MTG Arena. ',m.a.createElement("br",null),"Valid example lines: ",m.a.createElement("br",null),"Wizard Mentor ",m.a.createElement("br",null),"1 Battle Hymn ",m.a.createElement("br",null),"5 Forest ",m.a.createElement("br",null),"1 Cogwork Assembler (AER) 145")}var H=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(i.a)(this,a),n=t.call(this,e);var r=new x;return n.state={cardLoader:r,boardState:new O(r,I,8,Object(l.a)(n)),sideboardState:new O(r,[],1,Object(l.a)(n))},n}return Object(s.a)(a,[{key:"moveCardToOtherBoard",value:function(e,t,a){t.removeCard(e),a.addCard(e),this.setState({})}},{key:"addLand",value:function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,c,i,s,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.boardState,c=this.state.cardLoader,i=Object(o.a)(Array(a)),e.prev=3,i.s();case 5:if((s=i.n()).done){e.next=13;break}return s.value,e.next=9,c.getCardData(t);case 9:l=e.sent,n.addCard(l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i.e(e.t0);case 18:return e.prev=18,i.f(),e.finish(18);case 21:this.setState({});case 22:case"end":return e.stop()}}),e,this,[[3,15,18,21]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement(N,{boardState:this.state.boardState,moveCardToOtherBoard:function(t){e.moveCardToOtherBoard(t,e.state.boardState,e.state.sideboardState)}}),m.a.createElement(N,{boardState:this.state.sideboardState,moveCardToOtherBoard:function(t){e.moveCardToOtherBoard(t,e.state.sideboardState,e.state.boardState)}}),m.a.createElement(E,{id:"card-pool-input"}),m.a.createElement(k,{inputElementId:"card-pool-input",topLevelContainer:this}),m.a.createElement(R,{topLevelContainer:this}),m.a.createElement(_,{topLevelContainer:this}),m.a.createElement(w,{boardState:this.state.boardState,sideboardState:this.state.sideboardState}),m.a.createElement(B,{maindeckBoardState:this.state.boardState}),m.a.createElement(j,{addLand:function(t,a){return e.addLand(t,a)}}),m.a.createElement(z,null))}}]),a}(m.a.Component);v.a.render(m.a.createElement(C.a,{backend:b.a},m.a.createElement(H,null)),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.d3679640.chunk.js.map